Try {
Connect-MgGraph
Get-MgContext
}
catch {
Install-Module Microsoft.Graph.Authentication -Confirm:$false
Install-Module Microsoft.Graph.Users -Confirm:$false
Import-Module Microsoft.Graph.Authentication 
Import-Module Microsoft.Graph.Users 
}
write-host "enter tenant name (after the @ including the TLD)"
$tenant=read-host
$employeeid=1
write-host "how many users?"
[int]$UserCount= read-host
write-host "what starting point"
[int]$startingpt= Read-Host 
 $startingpt..$UserCount| ForEach-Object { $params= @{
 accountEnabled= $true
 displayName= "user$_"
 mailNickName= "user$_"
 userPrincipalName = "user$_@$tenant"
PasswordProfile= @{
    forceChangePasswordNextSignIn = $true   
    password = "xWwvJ]6NMw+bWH-d"
}
}
New-MgUser -BodyParameter $params

}
$employeeid = 0
$EmployeesAdded= $startingpt..$UserCount
$startingpt..$UserCount | % {

$employeeid += 1

Update-MgBetaUser -userId "user$_@$tenant"   -EmployeeId $employeeid

}
#find the midpt
$midpoint= [math]::Ceiling($EmployeesAdded.Count /2)
# split array in half using midpoint
$enabledUsers=$EmployeesAdded[0..($midpoint -1)]
$disabledUsers=$EmployeesAdded[$midpoint..($EmployeesAdded.Count - 1)]
$disabledUsers | % {
Write-Host " Disabling user$_@$tenant"
Update-MgBetaUser -UserId "user$_@$tenant" -AccountEnabled $false

}


